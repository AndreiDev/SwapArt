<li class="col-lg-3 col-md-4 col-sm-6 col-xs-12" data-item-id = "<%= locals[:item].id %>">
  <div class="thumbnail">
    <div class="thumbnail-image-div">
      <div style="direction: ltr"><p class="thumbnail_image_size"><%= locals[:item].width  %>X<%= locals[:item].height %></p></div>
      <% if locals[:item].user == current_user %>
        <% if locals[:item].is_active %>
          <%= link_to "", toggle_active_items_path(id: locals[:item].id), format: :json, remote: true, method: :post, :class => "btn btn-success toggle_active glyphicon glyphicon-eye-open" %>
        <% else %>
          <%= link_to "", toggle_active_items_path(id: locals[:item].id), format: :json, remote: true, method: :post, :class => "btn btn-warning thumbnail_close toggle_active glyphicon glyphicon-eye-close" %>
        <% end %>
      <% else %>
        <%= link_to "", apply_blocks_path(block: {item_id: locals[:item].id}), format: :json, remote: true, method: :post, :class => "btn btn-danger thumbnail_close fa fa-times" %>
      <% end %>
      <p class="text-center item-date"> <%= locals[:item].created_at.strftime("%d.%m.%Y") %> </p>
      <img src= <%= S3_PATH + locals[:item].image_url %> alt="" class="center-block">
    </div>
    <div class="caption">
      <p><%= locals[:item].description.present? ? locals[:item].description : "-" %></p>
      <p class="long-description"><%= locals[:item].type.description %> במצב   <%= locals[:item].state.description %> נקנה לפני  <%= locals[:item].age.description %> ב<%= locals[:item].price.description %></p>
      <br/><br/>
      <p class="user_name">
      <% if locals[:item].user == current_user || current_user.items.where(is_active: true, is_blocked: false).count == 0 || (locals[:item].user.items.count == 1 && locals[:state] < 3 )%>
        <%= locals[:item].user.first_name %> (<%= locals[:item].user.region.description %>)
      <% else %>
        <%= link_to "%s (%s)" % [locals[:item].user.first_name, locals[:item].user.region.description], modal_users_path(user_id: locals[:item].user_id), format: :json, remote: true, :class => "user_modal_link" %>
      <% end %>
      <% if locals[:state] == 3 || locals[:state] == 4 %>
        <span class="wants_to_swap">רוצה להתחלף!</span>
      <% end %>
      <p>
      <% if locals[:item].user == current_user %>
        <%= link_to "", edit_item_path(locals[:item]), :class => "btn btn-info fa fa-edit" %>
        <%= link_to "", locals[:item], method: :delete, data: { confirm: t('areYouSure') }, :class => "btn btn-danger pull-left fa fa-trash-o" %>
      <% else %>
        <% if current_user.items.where(is_active: true, is_blocked: false).count == 0 %>
          <%= link_to "", '#', :class => "btn btn-large btn-default toggle_want fa fa-thumbs-up disabled" %>
        <% else %>
          <% if locals[:state] == 2 || locals[:state] == 4  %>
            <%= link_to "", toggle_wants_path(want: {item_id: locals[:item].id}), format: :json, remote: true, method: :post, :class => "btn btn-large btn-success toggle_want fa fa-thumbs-up" %>
          <% else %>
            <%= link_to "", toggle_wants_path(want: {item_id: locals[:item].id}), format: :json, remote: true, method: :post, :class => "btn btn-large btn-default toggle_want fa fa-thumbs-up" %>
          <% end %>
        <% end %>
      <% end %>
      <% if current_user.items.where(is_active: true, is_blocked: false).count == 0 %>
        <%= link_to "בשביל להתחלף צריך לשתף", new_item_path, :class => "" %>
      <% end %>
      <% if locals[:state] == 4 %>
      <span class="user_info">
        <%= link_to "", modal_contact_users_path(user_id: locals[:item].user_id, item_id: locals[:item].id), format: :json, remote: true, :class => "btn btn-large btn-warning pull-left fa fa-info-circle" %>
      </span>
      <% end %>
      </p>
    </div>
  </div>
</li>
